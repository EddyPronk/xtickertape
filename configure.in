dnl Process this file with autoconf to produce a configure script.
AC_INIT(tickertape.c)
AM_INIT_AUTOMAKE(xtickertape, 2.0a1)

dnl Checks for programs.
AC_PROG_AWK
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_LN_S

dnl Checks for libraries.

# Check to see if we need -lnsl and/or -lsocket to use sockets.
AC_SEARCH_LIBS(connect, socket)
AC_SEARCH_LIBS(gethostbyname, nsl)

# See if we need -lcrypt for the crypt library
AC_SEARCH_LIBS(crypt, crypt)

# Figure out where X11 lives.
AC_PATH_X
if test "$no_x" = yes ; then
    AC_MSG_ERROR("Unable to find the X11 package")
    exit 1
fi

# Check to see if we can find the X library.
AC_CHECK_LIB(X11, XOpenDisplay)

# Check for the X toolkit library.
AC_CHECK_LIB(Xt, XtVaAppInitialize)

# Check for the X extensions library.
AC_CHECK_LIB(Xmu, _XEditResCheckMessages)

# Check for the X11 extensions library to see if we can make a shaped icon.
AC_CHECK_LIB(Xext, XShapeCombineMask)

# Check for the Motif library
AC_CHECK_LIB(Xm, XmCreatePulldownMenu)

# See if the elvin libraries look healthy
AC_ARG_WITH(elvin, [  --with-elvin=DIR       specify the elvin4 installation directory])

# Check for silliness
if test "$with_elvin" = no ; then
    AC_MSG_ERROR("xcoffeebiff cannot be compiled without elvin4")
    exit 1
fi

# See if a directory was provided
if test "$with_elvin" != yes ; then
    CPPFLAGS="-I$withval/include $CPPFLAGS"
    LDFLAGS="-L$withval/lib $LDFLAGS"
fi

# Check for the various libraries
AC_CHECK_LIB(vin4c, elvin_async_init,
    LIBS="-lvin4c -lvin4 $LIBS",
    AC_MSG_ERROR("unable to locate the elvin4 libraries"); exit 1,
    -vin4c -lvin4)

AC_CHECK_LIB(vin4Xt, elvin_xt_async_init,
    LIBS="-lvin4Xt $LIBS",
    AC_MSG_ERROR("unable to locate the elvin4 Xt main loop library"); exit 1
    -lvin4Xt)

dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(sys/time.h unistd.h crypt.h)


AC_CHECK_HEADER(Xm/Xm.h, ok=yes, ok=no)
if test "$ok" = "no" ; then
	echo "ERROR: \`Xm.h' is missing on your system.  You may obtain"
	echo "       a free Motif implementation from the Hungry Programmers"
	echo "       at http://www.lesstif.org/"
	exit 1
fi

dnl Check for the metamail program
AC_PATH_PROG(METAMAIL, metamail, not found, $DSTCDIR/script:$PATH)
if test "$METAMAIL" = "not found" ; then
	echo "WARNING: \`metamail\' is missing on your system. Without it,"
	echo "          xtickertape will be unable to decode MIME messages"
else
	AC_DEFINE_UNQUOTED(METAMAIL, "$METAMAIL")
fi

dnl Checks for header files.
dnl ========================
AC_HEADER_STDC


dnl Checks for typedefs, structures, and compiler characteristics.
dnl ==============================================================

dnl Checks for library functions.
dnl =============================
AC_CHECK_FUNCS(strdup)

AM_CONFIG_HEADER(config.h)
AC_OUTPUT(Makefile)
